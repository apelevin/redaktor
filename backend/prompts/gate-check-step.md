# GATE_CHECK Step Prompt

Проверь готовность состояния к генерации skeleton договора.

## Текущее состояние

```json
{{state_json}}
```

## Категории для проверки готовности

Проверь следующие категории:

1. **Роли сторон** (кто кому что обязан)
   - Определены ли стороны договора?
   - Понятны ли их роли и обязательства?

2. **Предмет сделки** (что является объектом)
   - Определен ли предмет договора?
   - Есть ли достаточно деталей для описания предмета?

3. **Коммерческая модель** (деньги/оплата/цена)
   - Определена ли цена или принцип определения цены?
   - Есть ли условия оплаты?

4. **Сроки/события исполнения** (когда и как происходит)
   - Определены ли сроки действия договора?
   - Есть ли условия исполнения обязательств?

5. **Отсутствие критических конфликтов**
   - Нет ли противоречий в фактах?
   - Нет ли конфликтующих требований?

6. **Подтверждение критических assumptions**
   - Все ли критические предположения подтверждены пользователем?
   - Нет ли неразрешенных assumptions с severity=critical?

## Требования к ответу

Верни JSON согласно схеме llm_step_output.schema.json с patch, который обновит `gate`:

```json
{
  "output_id": "уникальный_id",
  "step": "GATE_CHECK",
  "patch": {
    "format": "merge_patch",
    "ops": {
      "gate": {
        "ready_for_skeleton": true/false,
        "summary": "Краткое объяснение готовности/блокеров (1-3 предложения)",
        "blockers": [
          {
            "severity": "critical",
            "message": "Описание проблемы",
            "linked_issue_ids": ["issue_id"]
          }
        ]
      }
    }
  },
  "next_action": {
    "kind": "proceed_to_skeleton" или "ask_user",
    "ask_user": {
      "question_text": "Вопрос, который закрывает ближайший критичный блокер"
    }
  },
  "rationale": "Объяснение решения (1-3 предложения)"
}
```

## Правила определения готовности

- `ready_for_skeleton = true` только если:
  - Все категории 1-4 выполнены
  - Нет критических конфликтов
  - Все критические assumptions подтверждены

- Если `ready_for_skeleton = false`:
  - Укажи конкретные blockers
  - Свяжи blockers с issues через `linked_issue_ids`
  - Предложи вопрос, который закроет самый критичный blocker

- `summary` должен быть понятным для пользователя (не технический жаргон)
